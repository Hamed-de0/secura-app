from fastapi import APIRouter, Depends
from sqlalchemy.orm import Session
from app.schemas.controls.control_vulnerability_link import ControlVulnerabilityLinkCreate
from app.crud.controls import control_vulnerability_link
from app.database import get_db

router = APIRouter(prefix="/control-vulnerability-links", tags=["Control-Vulnerability Links"])


@router.post("/")
def create_link(link: ControlVulnerabilityLinkCreate, db: Session = Depends(get_db)):
    return control_vulnerability_link.create_control_vulnerability_link(db, link)


@router.delete("/")
def delete_link(control_id: int, vulnerability_id: int, db: Session = Depends(get_db)):
    return control_vulnerability_link.delete_control_vulnerability_link(db, control_id, vulnerability_id)
