from sqlalchemy import Column, Integer, ForeignKey
from sqlalchemy.orm import relationship
from app.core.base import BaseModel


class ControlVulnerabilityLink(BaseModel):
    __tablename__ = "control_vulnerability_links"

    control_id = Column(Integer, ForeignKey("controls.id", ondelete="CASCADE"))
    vulnerability_id = Column(Integer, ForeignKey("vulnerabilities.id", ondelete="CASCADE"))

    control = relationship("Control", back_populates="vulnerabilities")
    vulnerability = relationship("Vulnerability", back_populates="controls")
