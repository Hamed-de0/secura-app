from sqlalchemy import Column, Integer, String, Text, DateTime, Boolean
from sqlalchemy.orm import relationship
from app.core.base import BaseModel
from app.core.mixins import NameDescriptionMixin


class Vulnerability(BaseModel, NameDescriptionMixin):
    __tablename__ = 'vulnerabilities'

    category = Column(String(100))  # e.g., "Software", "Hardware", "Human"
    source = Column(String(100))  # e.g., "ISO 27005", "OWASP", "Custom"
    reference_code = Column(String(50))  # e.g., "V001", "ISO-V-3.4.1", "CVE-2021-1234"

    # Relationships (to be used later)
    threats = relationship("VulnerabilityThreatLink", back_populates="vulnerability")

