from sqlalchemy.orm import Session
from app.models.assets.asset_type_vulnerability_link import AssetTypeVulnerabilityLink
from app.schemas.assets.asset_type_vulnerability_link import AssetTypeVulnerabilityLinkCreate

def create_link(db: Session, link: AssetTypeVulnerabilityLinkCreate):
    db_link = AssetTypeVulnerabilityLink(**link.dict())
    db.add(db_link)
    db.commit()
    db.refresh(db_link)
    return db_link

def get_links_by_asset_type(db: Session, asset_type_id: int):
    return db.query(AssetTypeVulnerabilityLink).filter_by(asset_type_id=asset_type_id).all()

def delete_link(db: Session, link_id: int):
    db.query(AssetTypeVulnerabilityLink).filter_by(id=link_id).delete()
    db.commit()
