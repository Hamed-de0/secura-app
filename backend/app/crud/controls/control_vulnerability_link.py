from sqlalchemy.orm import Session
from app.models.controls.control_vulnerability_link import ControlVulnerabilityLink
from app.schemas.controls.control_vulnerability_link import ControlVulnerabilityLinkCreate

def create_control_vulnerability_link(db: Session, link: ControlVulnerabilityLinkCreate):
    db_link = ControlVulnerabilityLink(**link.model_dump())
    db.add(db_link)
    db.commit()
    db.refresh(db_link)
    return db_link

def delete_control_vulnerability_link(db: Session, control_id: int, vulnerability_id: int):
    db_link = db.query(ControlVulnerabilityLink).filter_by(
        control_id=control_id, vulnerability_id=vulnerability_id
    ).first()
    if db_link:
        db.delete(db_link)
        db.commit()
        return True
    return False
